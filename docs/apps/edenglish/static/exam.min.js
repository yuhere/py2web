function __init__(e){function t(e,t){t=void 0===t?"yyyy-MM-dd hh:mm:ss":t;var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),"S":e.getMilliseconds()};/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));for(var i in n){RegExp("("+i+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[i]:("00"+n[i]).substr((""+n[i]).length)))}return t}function n(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")}function i(e,t,n){return"<"+e+' class="'+t+'">'+n+"</"+e+">"}function a(e){var t=/[\u4E00-\u9FA5\uF900-\uFA2D]/;return t.test(e)}function s(e,t){t=void 0===t?"c":t;for(var s=[],r=0;r<e.length;r++){var o=e.charAt(r);s.push(i("span",t+(a(o)?" cc ":""),n(o)))}return s.join("")}function r(e){for(var t,n=[],a=/([a-z0-9]+)/gi,r=0;null!==(t=a.exec(e));){t.index===a.lastIndex&&a.lastIndex++;var o=t[1],d=e.substring(r,t.index);r=t.index+t[0].length,n.push(s(d)),n.push(i("span","w",s(o)))}return n.push(s(e.substring(r))),n.join("")}function o(e,t){for(var n=[],a=[],r=0;r<e.length;r++){var o=" w"+t+"c"+r,d=e.charCodeAt(r);n.push(s(e.charAt(r),"c s")),a.push(s(" ","c s"+(d>=97&&122>=d?" l":d>=65&&90>=d?" u":"")+o))}return{"span":i("span","w spw"+t,n.join("")),"input":i("span","w w"+t,a.join(""))}}function d(e){for(var t,i,a=b.split(/\r?\n/g),s=[],d=[],l=[],c=[],u=0;u<a.length;u++){var v=a[u];s.push("<p>"),l.push("<p>");for(var f,h=/\<w\>(.*?)\<\/w\>/gi,p=0;null!==(f=h.exec(v));){f.index===h.lastIndex&&h.lastIndex++;var g=f[1],m=v.substring(p,f.index);t=r(m),i=o(g,d.length),s.push(t+i.input),l.push(t+i.span),d.push(g.split("")),p=f.index+f[0].length}t=r(v.substring(p)),s.push(t),l.push(t),s.push("</p>\n"),l.push("</p>\n")}if(d.length>0){c.push("<table>"),c.push("<tr>"),c.push('<td colspan="2">Dictionary:</td>'),c.push("</tr>");for(var u=0;u<d.length;u++){var g=d[u].join(""),y=g;c.push("<tr>"),c.push('<td style="white-space: nowrap;"><button class="dic_btn_play">\ud83d\udd0a</button>'+y+"</td>"),c.push("<td>"),w.hasOwnProperty(y)?c.push(n(w[y].translation+"")):c.push(n("** MISS **")),c.push("</td>"),c.push("</tr>")}c.push("</table>")}return{"question":s.join(""),"answer":l.join(""),"dict":c.join(""),"words":d}}function l(e){e=void 0===e?"normal":e,function(){var s=document.getElementById("question"),r=document.getElementById("answer"),o=document.getElementById("dict"),d=["normal","exam","finish"],c=d.indexOf(e);d.splice(c,1);for(var u=0;u<d.length;u++){s.classList.contains(d[u])&&s.classList.remove(d[u]),r.classList.contains(d[u])&&r.classList.remove(d[u]),o.classList.contains(d[u])&&o.classList.remove(d[u])}!s.classList.contains(e)&&s.classList.add(e),!r.classList.contains(e)&&r.classList.add(e),!o.classList.contains(e)&&o.classList.add(e);var v=document.getElementById("header"),f=document.getElementById("qheader");if("normal"===e){v.innerHTML='<div><button id="btn_print">\ud83d\udda8\ufe0f</button><button id="btn_exam">\ud83c\udf93</button></div>',f.innerHTML="",f.style.visibility="hidden";var h=document.getElementById("btn_print"),p=document.getElementById("btn_exam");h.addEventListener("click",function(e){window.print()}),p.addEventListener("click",function(e){l("exam")})}else{if("exam"===e){v.innerHTML='<div><button id="btn_submit">\u2705</button><button id="btn_cancel">\u274e</button></div>',f.innerHTML='<div class="status"><span id="ir_count"></span><span id="remaining">\u231b00:00:00</span></div>',f.style.visibility="visible";var g=document.getElementById("btn_submit"),m=document.getElementById("btn_cancel");g.addEventListener("click",function(e){var s=y()?"\u662f\u5426\u8981\u63d0\u4ea4\uff1f":"\u770b\u6837\u5b50\u8fd8\u6ca1\u6709\u7b54\u5b8c\uff0c\u786e\u8ba4\u8981\u63d0\u4ea4\u5417\uff1f";confirm(s)&&(n&&clearInterval(n),n=void 0,L(),g.remove(),i.innerHTML="\u23f1"+t(new Date(a),"yyyy-MM-dd hh:mm")+" ~ "+t(new Date,"hh:mm"),l("finish"),setTimeout(function(){window.print()},100))}),m.addEventListener("click",function(e){"finish"===M?l("normal"):confirm("\u6d4b\u8bd5\u770b\u6837\u5b50\u8fd8\u6ca1\u6709\u7ed3\u675f\uff0c\u786e\u8ba4\u8981\u53d6\u6d88\u5417\uff1f")&&(n&&clearInterval(n),n=void 0,l("normal"))})}else{if("finish"===e){v.innerHTML='<div><button id="btn_back">\ud83d\udd19</button><button id="btn_reload">\ud83d\udd03</button></div>';var b=document.getElementById("btn_back"),m=document.getElementById("btn_cancel");b.addEventListener("click",function(e){l("normal")}),btn_reload.addEventListener("click",function(e){l("exam")})}}}}();var n,i=document.getElementById("remaining"),a=(new Date).getTime();"normal"===e?m():"exam"===e&&(m(),n=setInterval(function(){var e=Math.floor(((new Date).getTime()-a)/1e3),t=[];t.push((""+Math.floor(e/3600)).padStart(2,"0")),e%=3600,t.push((""+Math.floor(e/60)).padStart(2,"0")),e%=60,t.push((""+e).padStart(2,"0")),i.innerHTML="\u231b"+t.join(":")},1e3),f("w0c0")),M=e}function c(e){v()}function u(e){}function v(){var e=/w([0-9]+)c([0-9]+)/.exec(k),t=parseInt(e[1]),n=(parseInt(e[2]),C[t].join(""));w[n]&&w[n].audio&&x(w[n].audio)}function f(e){if(void 0===e){if(void 0!==k){var t=/w([0-9]+)c([0-9]+)/.exec(k),n=parseInt(t[1]),i=parseInt(t[2]),a=_[n][i],s=a.firstChild;s.nodeValue=B.value,B.remove(),a.classList.contains("f")&&a.classList.remove("f");var r=B.getAttribute("onchanging");null===r?u(n):B.removeAttribute("onchanging"),k=void 0}return!0}if(void 0===k){var o=/w([0-9]+)c([0-9]+)/.exec(e),d=parseInt(o[1]),l=parseInt(o[2]),v=_[d][l],f=v.firstChild;return B.value=f.nodeValue,B.classList.remove("l"),B.classList.remove("u"),v.classList.contains("l")&&B.classList.add("l"),v.classList.contains("u")&&B.classList.add("u"),!v.classList.contains("f")&&v.classList.add("f"),v.appendChild(B),B.focus(),k=e,c(d),!0}if(k===e){return B.selectionStart=0,B.selectionEnd=0,!1}var t=/w([0-9]+)c([0-9]+)/.exec(k),n=parseInt(t[1]),i=parseInt(t[2]),a=_[n][i],s=document.createTextNode(B.value||" "),o=/w([0-9]+)c([0-9]+)/.exec(e),d=parseInt(o[1]),l=parseInt(o[2]),v=_[d][l],f=v.firstChild;return B.setAttribute("onchanging","true"),B.blur(),n!==d&&u(n),B.value=f.nodeValue,B.classList.remove("l"),B.classList.remove("u"),v.classList.contains("l")&&B.classList.add("l"),v.classList.contains("u")&&B.classList.add("u"),!v.classList.contains("f")&&v.classList.add("f"),v.appendChild(B),B.focus(),k=e,n!==d&&c(d),!0}function h(e){function t(e){e=void 0===e?0:e;var t,n=/w([0-9]+)c([0-9]+)/.exec(k),i=parseInt(n[1]),a=parseInt(n[2])+(0===e?0:e>0?1:-1);if(0===e){return k}if(e>0){for(var s=i;s>=0&&s<_.length&&void 0===t;s++){for(var r=_[s],o=s===i?a:0;o>=0&&o<r.length&&void 0===t;o++){t="w"+s+"c"+o}}return void 0===t&&(t="w0c0"),t}if(0>e){for(var s=i;s>=0&&s<_.length&&void 0===t;s--){for(var r=_[s],o=s===i?a:r.length-1;o>=0&&o<r.length&&void 0===t;o--){t="w"+s+"c"+o}}return void 0===t&&(t="w"+(_.length-1)+"c"+(_[_.length-1].length-1)),t}}f(t(e))}function p(e){function t(e){e=void 0===e?0:e;var t,n=/w([0-9]+)c([0-9]+)/.exec(k),i=parseInt(n[1])+(0===e?0:e>0?1:-1);if(0===e){return k}if(e>0){for(var a=i;a>=0&&a<_.length&&void 0===t;a++){t="w"+a+"c0"}return void 0===t&&(t="w0c0"),t}if(0>e){for(var a=i;a>=0&&a<_.length&&void 0===t;a--){t="w"+a+"c0"}return void 0===t&&(t="w"+(_.length-1)+"c0"),t}}f(t(e))}function g(e){if(void 0!==k){var t=/w([0-9]+)c([0-9]+)/.exec(k),n=parseInt(t[1]),i=parseInt(t[2]);if("char"===e){var a=_[n][i].firstChild,s=a&&a.nextSibling;a.nodeValue=C[n][i],s&&(s.value=C[n][i])}else{if("word"===e){for(var r=C[n],o=0;o<r.length;o++){var a=_[n][o].firstChild,s=a&&a.nextSibling;a.nodeValue=r[o],s&&(s.value=r[o])}}else{if("part"===e){for(var r=C[n],o=0;o<r.length;o++){if(-1!==["a","e","i","o","u"].indexOf(r[o].toLowerCase())){var a=_[n][o].firstChild,s=a&&a.nextSibling;a.nodeValue=r[o],s&&(s.value=r[o])}}}}}}}function m(){f();for(var e=0;e<_.length;e++){for(var t=0;t<_[e].length;t++){var n=_[e][t].firstChild,i=document.createTextNode(" ");_[e][t].replaceChild(i,n),_[e][t].classList.contains("x")&&_[e][t].classList.remove("x")}}y()}function y(){for(var e=0,t=0,n=_.length,i=0,a=document.getElementById("ir_count"),s=0;s<_.length;s++){for(var r=0,o=0;o<_[s].length;o++){e+=1;var d=_[s][o].firstChild,l=3!==d.nodeType?d.value:d.nodeValue;" "!==l&&(t+=1,r+=1)}r===_[s].length&&(i+=1)}return a&&(a.innerHTML="\ud83d\udcdd"+(i+"/"+n+","+t+"/"+e)),i===n}function L(){for(var e=0,t=0,n=_.length,i=0,a=document.getElementById("ir_count"),s=0;s<_.length;s++){for(var r=0,o=0;o<_[s].length;o++){e+=1;var d=_[s][o].firstChild,l=3!==d.nodeType?d.value:d.nodeValue;l.toLowerCase()===C[s][o].toLowerCase()?(t+=1,r+=1,_[s][o].classList.contains("x")&&_[s][o].classList.remove("x")):!_[s][o].classList.contains("x")&&_[s][o].classList.add("x")}r===_[s].length&&(i+=1)}console.log("check result: words count: ",i+" / "+n+", chars count: ",t+" / "+e);var c=Math.floor(100*i/n),u=Math.floor(100*t/e);a&&(a.innerHTML="\ud83d\udccb"+(i+"/"+n+"="+c+"%"+(c>=80?"\ud83d\udc4d":"\ud83d\udc4e")+","+t+"/"+e+"="+c+"%"+(u>=80?"\ud83d\udc4d":"\ud83d\udc4e")))}var b=e.marked,w=e.dict,x=(e.qid,function(){var e=new Audio,t=!1;if(/i(Phone|P(o|a)d)/.test(navigator.userAgent)){var n=function(){return e.load(),t=!0,!1};document.addEventListener("touchstart",n)}else{t=!0}return function(n){t&&(e.pause(),e.src=n,e.play())}}()),E=d(),C=E.words,I='<div id="header" class="ctl"></div><div id="question" class="block"><div id="qheader" class="block"></div><div>'+E.question+'</div></div><div id="answer" class="block"><div>'+E.answer+'</div></div><div id="dict" class="block">'+E.dict+"</div>";document.getElementById("main").innerHTML=I,function(){for(var e=document.getElementsByClassName("dic_btn_play"),t=0;t<e.length;t++){e[t].addEventListener("click",function(e){var t=e.target,n=t.nextSibling,i=n.nodeValue;x(w[i].audio)})}}();var k,M="normal",_=C.map(function(e,t){var n=document.getElementsByClassName("spw"+t)[0];return n.addEventListener("mousedown",function(t){if("normal"===M){var n=e.join("");w[n]&&w[n].audio&&x(w[n].audio)}}),e.map(function(e,n){var i="w"+t+"c"+n,a=document.getElementsByClassName(i)[0];return a.addEventListener("mousedown",function(e){"exam"===M&&(f(i),e.preventDefault(),e.stopPropagation())}),a})}),B=function(){var e=document.createElement("input");e.classList.add("i"),e.setAttribute("maxlength","1"),e.value=" ",e.addEventListener("input",function(n){n.target.value;t&&""!==e.value||(e.value=" ",e.selectionStart=0,e.selectionEnd=0),y()});var t=!1;return e.addEventListener("keydown",function(n){if(t=!0,8===n.keyCode){e.value=" ",h(-1),y()}else{if(38===n.keyCode){p(-1)}else{if(40===n.keyCode){p(1)}else{if(37===n.keyCode){h(-1)}else{if(39===n.keyCode){h(1)}else{if(46===n.keyCode){e.value=" ",e.selectionStart=0,e.selectionEnd=0,y()}else{if(32===n.keyCode){e.value=" ",h(1),y()}else{if(9===n.keyCode||13===n.keyCode){if(n.ctrlKey){var i=document.getElementById("btn_submit");i&&i.focus()+i.click()}else{h(n.shiftKey?-1:1)}}else{n.ctrlKey||n.altKey||n.metaKey||!(n.keyCode>=65&&n.keyCode<=90||n.keyCode>=97&&n.keyCode<=122||222===n.keyCode)?-1!==[186].indexOf(n.keyCode)?v():188===n.keyCode?v():190===n.keyCode?(g("word"),y()):191===n.keyCode?(g("part"),y()):t=!1:(e.value=String.fromCharCode(222===n.keyCode?39:n.keyCode),h(1),y())}}}}}}}}n.preventDefault(),n.stopPropagation()}),e.addEventListener("focus",function(t){e.selectionStart=0,e.selectionEnd=0}),e.addEventListener("blur",function(e){f()}),e}();l()}